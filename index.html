<!-- Vertex AI Search Widget -->
<script src="https://cloud.google.com/ai/gen-app-builder/client?hl=en_US"></script>

<style>
  html, body {
    margin: 0;
    padding: 0;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background: #f9f9f9;
    color: #222;
    overflow-x: hidden;
  }

  .container {
    text-align: center;
    padding: 4vh 1rem 2rem;
  }

  h1 {
    font-size: 1.6rem;
    font-weight: 600;
    margin-bottom: 1rem;
    line-height: 1.3;
  }

  p {
    font-size: 1rem;
    max-width: 600px;
    margin: 0 auto 2rem auto;
    line-height: 1.5;
  }

  a {
    color: #0056b3;
    text-decoration: underline;
    word-break: break-word;
  }

  .search-container {
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding: 0 1rem 4vh;
    box-sizing: border-box;
  }

  #searchWidgetTrigger {
    width: 100%;
    max-width: 420px;
    padding: 1rem 1.2rem;
    font-size: 1.05rem;
    border-radius: 10px;
    border: 1px solid #ddd;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.06);
    background: #fff;
    outline: none;
  }

  @media (max-width: 600px) {
    h1 {
      font-size: 1.25rem;
    }

    p {
      font-size: 0.95rem;
    }

    #searchWidgetTrigger {
      font-size: 1rem;
      padding: 0.9rem 1rem;
      max-width: 100%;
    }
  }
</style>

<div class="container">
  <h1>Civic AI Search</h1>
  <h2>Whitehorse</h2>

  <p>
    Ask Questions Based on City Council Agendas, Minutes, and Reports<br />
    Get clear, reliable answers grounded in official Whitehorse City Council meeting documents.<br />
    All responses are sourced from published agendas, minutes, and supporting reports available at:<br />
    <a href="https://www.whitehorse.ca/our-government/city-council/meetings/agendas-minutes-and-reports/" target="_blank">
      whitehorse.ca/city-council/meetings/agendas-minutes-and-reports/
    </a>
  </p>
</div>

<div class="search-container">
  <input placeholder="Search here" id="searchWidgetTrigger" />
</div>

<gen-search-widget
  configId="c6d6616c-c71f-4f1b-b5af-9344fcd18aa9"
  triggerId="searchWidgetTrigger">
</gen-search-widget>

<!-- Patch internal widget styling for mobile -->
<script>
  const resizeWidgetIfReady = () => {
    const widget = document.querySelector('gen-search-widget');
    if (!widget?.shadowRoot) return;

    const resize = () => {
      const container = widget.shadowRoot.querySelector('cag-search');
      if (container) {
        container.style.width = '100%';
        container.style.maxWidth = '100vw';
        container.style.padding = '0 1rem';
      }

      const inner = widget.shadowRoot.querySelector('.dialog, .container');
      if (inner) {
        inner.style.maxWidth = '100%';
      }
    };

    resize();

    // Reapply on future DOM changes inside widget
    const observer = new MutationObserver(resize);
    observer.observe(widget.shadowRoot, { childList: true, subtree: true });
  };

  window.addEventListener('load', () => {
    const poll = setInterval(() => {
      const widget = document.querySelector('gen-search-widget');
      if (widget && widget.shadowRoot) {
        clearInterval(poll);
        resizeWidgetIfReady();
      }
    }, 200);
  });
</script>
